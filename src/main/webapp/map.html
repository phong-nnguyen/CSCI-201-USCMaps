<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USC Campus Map</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="map.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="images/Logos/TrojanMap_White_Logo.png">
</head>
<body class="map-page">
    <header>
        <nav>
            <div class="logo">
                <img src="images/Logos/TrojanMap_White_Logo.png" alt="USC Logo">
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="map.html">Map</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="friends.html">Friends</a></li>
                <li class="auth-links login-link"><a href="login.html">Login</a></li>
                <li class="auth-links register-link"><a href="register.html">Register</a></li>
                <li class="user-welcome" style="display: none;">
                    Welcome, <span id="username"></span>!
                </li>
                <li class="logout-link" style="display: none;">
                    <a href="#" id="logout-btn">Logout</a>
                </li>
            </ul>
        </nav>
    </header>

    <div class="content-container">
        <div id="sidebar">
            <div class="input-card">
                <div class="greeting">Hey, <span id="user-name">Trojan</span>!</div>
                <div class="prompt">Where do you want to go?</div>

                <div class="location-input-group">
                    <input id="origin" class="location-input" type="text" placeholder="Beginning">
                    <button id="origin-location" class="location-button-small">&#128205;</button>
                    <div class="dropdown-arrow">&#9660;</div>
                    <div class="location-dropdown" id="origin-dropdown">
                        <div class="dropdown-item" data-value="Tommy Trojan Statue, Los Angeles, CA">Tommy Trojan</div>
                        <div class="dropdown-item" data-value="USC Village, Los Angeles, CA">USC Village</div>
                        <div class="dropdown-item" data-value="Doheny Memorial Library, Los Angeles, CA">Doheny Library</div>
                        <div class="dropdown-item" data-value="USC Viterbi School of Engineering, Los Angeles, CA">Viterbi Engineering</div>
                        <div class="dropdown-item" data-value="USC Marshall School of Business, Los Angeles, CA">Marshall Business</div>
                        <div class="dropdown-item" data-value="USC School of Cinematic Arts, Los Angeles, CA">Cinematic Arts</div>
                        <div class="dropdown-item" data-value="USC Annenberg School, Los Angeles, CA">Annenberg School</div>
                        <div class="dropdown-item" data-value="Galen Center, Los Angeles, CA">Galen Center</div>
                        <div class="dropdown-item" data-value="Los Angeles Memorial Coliseum, Los Angeles, CA">LA Coliseum</div>
                        <div class="dropdown-item" data-value="USC Keck School of Medicine, Los Angeles, CA">Keck Medicine</div>
                    </div>
                </div>

                <div class="location-input-group">
                    <input id="destination" class="location-input" type="text" placeholder="Destination">
                    <button id="destination-location" class="location-button-small">&#128205;</button>
                    <div class="dropdown-arrow">&#9660;</div>
                    <div class="location-dropdown" id="destination-dropdown">
                        <div class="dropdown-item" data-value="Tommy Trojan Statue, Los Angeles, CA">Tommy Trojan</div>
                        <div class="dropdown-item" data-value="USC Village, Los Angeles, CA">USC Village</div>
                        <div class="dropdown-item" data-value="Doheny Memorial Library, Los Angeles, CA">Doheny Library</div>
                        <div class="dropdown-item" data-value="USC Viterbi School of Engineering, Los Angeles, CA">Viterbi Engineering</div>
                        <div class="dropdown-item" data-value="USC Marshall School of Business, Los Angeles, CA">Marshall Business</div>
                        <div class="dropdown-item" data-value="USC School of Cinematic Arts, Los Angeles, CA">Cinematic Arts</div>
                        <div class="dropdown-item" data-value="USC Annenberg School, Los Angeles, CA">Annenberg School</div>
                        <div class="dropdown-item" data-value="Galen Center, Los Angeles, CA">Galen Center</div>
                        <div class="dropdown-item" data-value="Los Angeles Memorial Coliseum, Los Angeles, CA">LA Coliseum</div>
                        <div class="dropdown-item" data-value="USC Keck School of Medicine, Los Angeles, CA">Keck Medicine</div>
                    </div>
                </div>
                <button id="calculate-route" class="action-button go-button">Go</button>
            </div>

            <div id="route-info" class="route-info"></div>
            <div id="directions-panel"></div>

            <!-- Container for print content -->
            <div id="print-container" style="display: none;"></div>
        </div>

        <div id="map"></div>
    </div>

    <!-- First load script.js which contains the setupDropdowns function -->
    <script src="script.js?v=3"></script>
    <!-- Then load map.js -->
   <script src="map.js?v=1"></script>

    <!-- Load Google Maps API directly with the API key -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDGIPlUnED-AeiAjI7oZaQm6WDPzpSpMPg&libraries=places&callback=initMap" async defer></script>
    
    <!-- Ensure dropdowns are set up regardless of other script loading -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Manually set up dropdown functionality
            // Origin dropdown
            const originArrow = document.querySelector('#origin + button + .dropdown-arrow');
            const originDropdown = document.getElementById('origin-dropdown');
            
            if (originArrow && originDropdown) {
                originArrow.addEventListener('click', function() {
                    originDropdown.classList.toggle('active');
                });
            }
            
            // Destination dropdown
            const destArrow = document.querySelector('#destination + button + .dropdown-arrow');
            const destDropdown = document.getElementById('destination-dropdown');
            
            if (destArrow && destDropdown) {
                destArrow.addEventListener('click', function() {
                    destDropdown.classList.toggle('active');
                });
            }
            
            // Set up click handlers for origin dropdown items
            document.querySelectorAll('#origin-dropdown .dropdown-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.getElementById('origin').value = this.getAttribute('data-value');
                    originDropdown.classList.remove('active');
                });
            });
            
            // Set up click handlers for destination dropdown items
            document.querySelectorAll('#destination-dropdown .dropdown-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.getElementById('destination').value = this.getAttribute('data-value');
                    destDropdown.classList.remove('active');
                });
            });
            
            // Close dropdowns when clicking outside
            window.addEventListener('click', function(e) {
                if (!e.target.matches('.dropdown-arrow') && !e.target.matches('.dropdown-item')) {
                    document.querySelectorAll('.location-dropdown').forEach(dropdown => {
                        dropdown.classList.remove('active');
                    });
                }
            });
            
            // Display the directions panel after route calculation
            const calculateButton = document.getElementById('calculate-route');
            if (calculateButton) {
                calculateButton.addEventListener('click', function() {
                    // Show the directions panel
                    const directionsPanel = document.getElementById('directions-panel');
                    if (directionsPanel) {
                        setTimeout(function() {
                            directionsPanel.classList.add('active');
                        }, 500); // Short delay to allow directions to load
                    }
                });
            }
        });
    </script>
</body>
</html> 